<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåÄ AI Pseudo ‚Üí Code Converter</title>
  
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- Prism.js for beautiful syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
  
  <style>
    * { 
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(145deg, #0a0f1e 0%, #141b2b 100%);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      padding: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .glass-card {
      background: rgba(18, 26, 40, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(74, 144, 226, 0.2);
      border-radius: 2rem;
      box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(59, 130, 246, 0.2) inset;
      padding: 2rem;
      width: 100%;
      max-width: 1600px;
    }
    
    h1 {
      font-weight: 700;
      font-size: 2.4rem;
      background: linear-gradient(135deg, #93c5fd, #60a5fa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }
    
    h1 i {
      background: linear-gradient(135deg, #1e3a8a, #1e40af);
      color: white;
      padding: 0.8rem;
      border-radius: 1.5rem;
      font-size: 1.8rem;
      box-shadow: 0 10px 20px -5px #000;
      border: 1px solid rgba(255,255,255,0.1);
      -webkit-text-fill-color: white;
    }
    
    .subtitle {
      color: #94a3b8;
      margin-bottom: 1.5rem;
      border-left: 4px solid #3b82f6;
      padding-left: 1.2rem;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 0 1rem 1rem 0;
      padding: 0.8rem 1.5rem;
      font-size: 0.95rem;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .stat-card {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 1rem;
      padding: 0.8rem 1.2rem;
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }
    
    .stat-icon {
      width: 2.5rem;
      height: 2.5rem;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #3b82f6;
      font-size: 1.2rem;
    }
    
    .stat-info h3 {
      font-size: 0.8rem;
      color: #64748b;
      font-weight: 500;
    }
    
    .stat-info p {
      font-size: 1rem;
      color: #e2e8f0;
      font-weight: 600;
    }
    
    .editor-panel {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    
    .pane {
      flex: 1 1 450px;
      background: rgba(10, 15, 25, 0.7);
      border-radius: 1.5rem;
      padding: 1.5rem;
      border: 1px solid rgba(255,255,255,0.03);
      box-shadow: 0 15px 35px -15px #000;
    }
    
    .pane-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    
    .pane-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #e2e8f0;
      font-weight: 600;
    }
    
    .pane-title i {
      color: #3b82f6;
      background: rgba(59, 130, 246, 0.1);
      padding: 0.5rem;
      border-radius: 0.8rem;
    }
    
    .char-count {
      background: rgba(255,255,255,0.03);
      padding: 0.3rem 1rem;
      border-radius: 2rem;
      font-size: 0.8rem;
      color: #64748b;
      border: 1px solid rgba(255,255,255,0.05);
    }
    
    textarea {
      width: 100%;
      height: 350px;
      background: #0a0f1a !important;
      border: 1px solid #1e2a3a !important;
      border-radius: 1rem !important;
      padding: 1.2rem !important;
      font-family: 'Fira Code', monospace !important;
      font-size: 0.9rem !important;
      line-height: 1.6 !important;
      color: #e2e8f0 !important;
      resize: vertical;
      outline: none;
    }
    
    textarea:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2) !important;
    }
    
    .code-container {
      position: relative;
      background: #0a0f1a !important;
      border: 1px solid #1e2a3a !important;
      border-radius: 1rem !important;
      height: 350px;
      overflow: auto;
    }
    
    pre {
      margin: 0 !important;
      padding: 1.2rem !important;
      background: transparent !important;
    }
    
    code {
      font-family: 'Fira Code', monospace !important;
      font-size: 0.9rem !important;
      line-height: 1.6 !important;
      text-shadow: none !important;
    }
    
    .toolbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin-top: 1rem;
      gap: 1rem;
    }
    
    .lang-pills {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      background: rgba(0,0,0,0.3);
      padding: 0.5rem;
      border-radius: 3rem;
      border: 1px solid rgba(255,255,255,0.05);
    }
    
    .lang-btn {
      padding: 0.6rem 1.5rem;
      border: none;
      background: transparent;
      color: #94a3b8;
      border-radius: 2rem;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .lang-btn:hover {
      background: rgba(59, 130, 246, 0.1);
      color: #e2e8f0;
    }
    
    .lang-btn.active {
      background: #3b82f6;
      color: white;
      box-shadow: 0 5px 15px -5px #1e3a8a;
    }
    
    .action-btns {
      display: flex;
      gap: 0.5rem;
    }
    
    .btn {
      padding: 0.7rem 1.5rem;
      border: none;
      border-radius: 2rem;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background: #3b82f6;
      color: white;
      box-shadow: 0 10px 20px -8px #1e3a8a;
    }
    
    .btn-primary:hover {
      background: #2563eb;
      transform: translateY(-2px);
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.03);
      color: #cbd5e1;
      border: 1px solid rgba(255,255,255,0.05);
    }
    
    .btn-secondary:hover {
      background: rgba(59, 130, 246, 0.2);
      color: white;
      border-color: #3b82f6;
    }
    
    .action-links {
      display: flex;
      gap: 1.5rem;
      margin-top: 0.8rem;
    }
    
    .action-link {
      color: #64748b;
      font-size: 0.9rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.3rem;
      transition: color 0.2s;
    }
    
    .action-link:hover {
      color: #3b82f6;
    }
    
    .footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid rgba(255,255,255,0.05);
      color: #64748b;
      font-size: 0.85rem;
    }
    
    .status-badge {
      background: rgba(16, 185, 129, 0.1);
      color: #10b981;
      padding: 0.4rem 1.2rem;
      border-radius: 2rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border: 1px solid rgba(16, 185, 129, 0.2);
    }
    
    .status-badge i {
      font-size: 0.6rem;
    }
    
    .loading {
      display: inline-block;
      width: 1rem;
      height: 1rem;
      border: 2px solid rgba(255,255,255,0.2);
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background: #1e293b;
      color: white;
      padding: 1rem 2rem;
      border-radius: 3rem;
      box-shadow: 0 15px 30px -10px #000;
      border-left: 4px solid #3b82f6;
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
  </style>
</head>
<body>
<div class="glass-card">
  <h1>
    <i class="fas fa-brain"></i>
    AI Pseudo ‚Üí Code Converter
  </h1>
  
  <div class="subtitle">
    <i class="fa-regular fa-lightbulb"></i>
    powered by Groq Llama 3.3 ¬∑ real-time translation ¬∑ syntax highlighting
  </div>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-code"></i></div>
      <div class="stat-info">
        <h3>MODEL</h3>
        <p>llama-3.3-70b</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-globe"></i></div>
      <div class="stat-info">
        <h3>LANGUAGES</h3>
        <p>5 supported</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-bolt"></i></div>
      <div class="stat-info">
        <h3>SPEED</h3>
        <p>~3-4 seconds</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-infinity"></i></div>
      <div class="stat-info">
        <h3>PRICING</h3>
        <p>free tier</p>
      </div>
    </div>
  </div>

  <div class="editor-panel">
    <!-- Input Pane -->
    <div class="pane">
      <div class="pane-header">
        <span class="pane-title">
          <i class="fas fa-pen-fancy"></i>
          your pseudo code
        </span>
        <span class="char-count" id="inputCharCount">0 characters</span>
      </div>
      
      <textarea id="pseudoInput" placeholder="# Write your algorithm in plain English or pseudo code..."></textarea>
      
      <div class="action-links">
        <span class="action-link" onclick="loadExample()">
          <i class="fa-regular fa-file-lines"></i> load example
        </span>
        <span class="action-link" onclick="clearInput()">
          <i class="fa-regular fa-trash-can"></i> clear
        </span>
        <span class="action-link" onclick="insertTemplate()">
          <i class="fa-regular fa-clipboard"></i> template
        </span>
      </div>
    </div>

    <!-- Output Pane -->
    <div class="pane">
      <div class="pane-header">
        <span class="pane-title">
          <i class="fas fa-microchip"></i>
          generated code
        </span>
        <span class="char-count" id="outputCharCount">0 characters</span>
      </div>
      
      <div class="code-container line-numbers">
        <pre><code id="codeContent" class="language-python">// Click convert to see beautifully highlighted code</code></pre>
      </div>
      
      <div class="toolbar">
        <div class="lang-pills" id="langSelector">
          <button class="lang-btn active" data-lang="python">Python</button>
          <button class="lang-btn" data-lang="java">Java</button>
          <button class="lang-btn" data-lang="cpp">C++</button>
          <button class="lang-btn" data-lang="javascript">JavaScript</button>
          <button class="lang-btn" data-lang="rust">Rust</button>
        </div>
        
        <div class="action-btns">
          <button class="btn btn-primary" id="convertBtn">
            <i class="fas fa-sync-alt"></i> convert
          </button>
          <button class="btn btn-secondary" id="copyBtn" title="Copy to clipboard">
            <i class="far fa-copy"></i>
          </button>
          <button class="btn btn-secondary" id="downloadBtn" title="Download as file">
            <i class="fas fa-download"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="status-badge" id="apiStatus">
      <i class="fas fa-circle"></i>
      connected to Groq API
    </div>
    <div>
      <i class="fa-regular fa-heart" style="color: #ef4444;"></i>
      built for computing students
    </div>
    <div>
      <i class="fa-regular fa-clock"></i>
      <span id="timestamp">ready</span>
    </div>
  </div>
</div>

<!-- Prism.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-rust.min.js"></script>

<script>
(function() {
  // DOM Elements
  const pseudoInput = document.getElementById('pseudoInput');
  const codeContent = document.getElementById('codeContent');
  const convertBtn = document.getElementById('convertBtn');
  const copyBtn = document.getElementById('copyBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const langBtns = document.querySelectorAll('.lang-btn');
  const inputCharCount = document.getElementById('inputCharCount');
  const outputCharCount = document.getElementById('outputCharCount');
  const timestamp = document.getElementById('timestamp');
  const apiStatus = document.getElementById('apiStatus');

  let currentLang = 'python';
  let currentCode = '';

  // Update input character count
  pseudoInput.addEventListener('input', () => {
    inputCharCount.textContent = pseudoInput.value.length + ' characters';
  });

  // Language selector
  langBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      langBtns.forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      currentLang = this.dataset.lang;
      
      if (currentCode) {
        highlightCode(currentCode, currentLang);
      }
    });
  });

  // Syntax highlighting function
  function highlightCode(code, lang) {
    currentCode = code;
    codeContent.textContent = code;
    codeContent.className = `language-${lang}`;
    outputCharCount.textContent = code.length + ' characters';
    
    if (window.Prism) {
      Prism.highlightElement(codeContent);
    }
    
    timestamp.textContent = new Date().toLocaleTimeString();
  }

  // Show toast notification
  function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.className = 'toast';
    toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}" style="color: ${type === 'success' ? '#10b981' : '#ef4444'}; margin-right: 0.5rem;"></i>${message}`;
    document.body.appendChild(toast);
    
    setTimeout(() => {
      toast.style.animation = 'slideIn 0.3s reverse';
      setTimeout(() => toast.remove(), 300);
    }, 2000);
  }

  // Convert pseudo code
  async function convert() {
    const pseudo = pseudoInput.value.trim();
    
    if (!pseudo) {
      showToast('Please enter some pseudo code', 'error');
      return;
    }

    // Show loading state
    codeContent.textContent = '// Converting...';
    codeContent.className = `language-${currentLang}`;
    apiStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> processing';

    try {
      const response = await fetch('/api/translate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ pseudo, language: currentLang })
      });

      const data = await response.json();

      if (data.success) {
        highlightCode(data.code, currentLang);
        showToast('‚úÖ Conversion successful!');
        apiStatus.innerHTML = '<i class="fas fa-circle" style="color: #10b981;"></i> connected to Groq API';
      } else {
        codeContent.textContent = `// Error: ${data.error}`;
        showToast('‚ùå Conversion failed', 'error');
        apiStatus.innerHTML = '<i class="fas fa-circle" style="color: #ef4444;"></i> API error';
      }
    } catch (err) {
      codeContent.textContent = `// Network error: ${err.message}`;
      showToast('üåê Network error - is server running?', 'error');
      apiStatus.innerHTML = '<i class="fas fa-circle" style="color: #ef4444;"></i> disconnected';
    }
  }

  // Copy to clipboard
  copyBtn.addEventListener('click', () => {
    if (!currentCode) {
      showToast('Nothing to copy', 'error');
      return;
    }
    
    navigator.clipboard.writeText(currentCode).then(() => {
      showToast('‚úÖ Copied to clipboard!');
    }).catch(() => {
      showToast('‚ùå Copy failed', 'error');
    });
  });

  // Download as file
  downloadBtn.addEventListener('click', () => {
    if (!currentCode) {
      showToast('No code to download', 'error');
      return;
    }

    const extensions = {
      python: 'py',
      java: 'java',
      cpp: 'cpp',
      javascript: 'js',
      rust: 'rs'
    };

    const ext = extensions[currentLang] || 'txt';
    const blob = new Blob([currentCode], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `code.${ext}`;
    a.click();
    URL.revokeObjectURL(url);
    
    showToast(`üìÅ Downloaded as code.${ext}`);
  });

  // Load example
  window.loadExample = () => {
    pseudoInput.value = `x = 10
if (x > 5) then
    print "x is greater than 5"
else
    print "x is small"
end if

for i = 1 to 5
    print "loop: " + i
end for

while (x > 0)
    print x
    x = x - 1
end while`;
    inputCharCount.textContent = pseudoInput.value.length + ' characters';
    showToast('üìã Example loaded');
  };

  // Insert template
  window.insertTemplate = () => {
    pseudoInput.value = `# Binary Search Algorithm
arr = [2, 5, 8, 12, 16, 23, 38, 45, 56, 72]
target = 23
left = 0
right = length(arr) - 1
found = false

while left <= right and not found
    mid = (left + right) / 2
    if arr[mid] == target then
        found = true
        print "Found at index: " + mid
    else if arr[mid] < target then
        left = mid + 1
    else
        right = mid - 1
    end if
end while

if not found then
    print "Target not found"
end if`;
    inputCharCount.textContent = pseudoInput.value.length + ' characters';
    showToast('üìã Template inserted');
  };

  // Clear input
  window.clearInput = () => {
    pseudoInput.value = '';
    inputCharCount.textContent = '0 characters';
    showToast('üßπ Cleared');
  };

  // Convert on button click
  convertBtn.addEventListener('click', convert);

  // Keyboard shortcut: Ctrl+Enter
  pseudoInput.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
      e.preventDefault();
      convert();
    }
  });

  // Check API health on load
  fetch('/api/health')
    .then(response => response.json())
    .then(data => {
      if (data.status === 'running') {
        apiStatus.innerHTML = '<i class="fas fa-circle" style="color: #10b981;"></i> connected to Groq API';
      }
    })
    .catch(() => {
      apiStatus.innerHTML = '<i class="fas fa-circle" style="color: #ef4444;"></i> server not running';
    });

  // Initialize
  inputCharCount.textContent = pseudoInput.value.length + ' characters';
  
  // Load example on first visit if empty
  if (!pseudoInput.value.trim()) {
    loadExample();
  }
})();
</script>
</body>
</html>